<?php require __DIR__ . '/template/header.phtml'; ?>
<h2 class="h4 mb-3">Browse Pets</h2>
<form class="row g-2 mb-3" method="get" action="/pets.php">
  <div class="col-md-4">
    <input class="form-control" name="q" placeholder="Search name/description" value="<?= htmlspecialchars($q) ?>">
  </div>
  <div class="col-md-3">
    <select class="form-select" name="type">
      <option value="">Any type</option>
      <?php foreach (['Dog','Cat','Parrot'] as $t): ?>
        <option value="<?= $t ?>" <?= $type===$t?'selected':'' ?>><?= $t ?></option>
      <?php endforeach; ?>
    </select>
  </div>
  <div class="col-md-3">
    <select class="form-select" name="status">
      <option value="">Any status</option>
      <?php foreach (['Missing','Found'] as $s): ?>
        <option value="<?= $s ?>" <?= $status===$s?'selected':'' ?>><?= $s ?></option>
      <?php endforeach; ?>
    </select>
  </div>
  <div class="col-md-2">
    <button class="btn btn-secondary w-100">Search</button>
  </div>
</form>

<div class="table-responsive">
<table class="table table-striped align-middle">
  <thead><tr><th>Name</th><th>Type</th><th>Status</th><th>Owner</th><th>Description</th></tr></thead>
  <tbody>
    <?php foreach ($pets as $p): ?>
    <tr>
      <td><?= htmlspecialchars($p['name']) ?></td>
      <td><?= htmlspecialchars($p['type']) ?></td>
      <td>
        <?php if ($p['status']==='Missing'): ?>
          <span class="badge text-bg-danger">Missing</span>
        <?php else: ?>
          <span class="badge text-bg-success">Found</span>
        <?php endif; ?>
      </td>
      <td><?= htmlspecialchars($p['owner_name']) ?></td>
      <td><?= htmlspecialchars($p['description']) ?></td>
    </tr>
    <?php endforeach; ?>
  </tbody>
</table>
</div>

<?php if ($pages > 1): ?>
<nav>
  <ul class="pagination">
    <li class="page-item <?= $page<=1?'disabled':'' ?>"><a class="page-link" href="?<?= http_build_query(['q'=>$q,'type'=>$type,'status'=>$status,'page'=>max(1,$page-1)]) ?>">Prev</a></li>
    <?php for ($i=1; $i<=$pages && $i<=10; $i++): ?>
      <li class="page-item <?= $i===$page?'active':'' ?>"><a class="page-link" href="?<?= http_build_query(['q'=>$q,'type'=>$type,'status'=>$status,'page'=>$i]) ?>"><?= $i ?></a></li>
    <?php endfor; ?>
    <li class="page-item <?= $page>=$pages?'disabled':'' ?>"><a class="page-link" href="?<?= http_build_query(['q'=>$q,'type'=>$type,'status'=>$status,'page'=>min($pages,$page+1)]) ?>">Next</a></li>
  </ul>
</nav>
<?php endif; ?>

<?php require __DIR__ . '/template/footer.phtml'; ?>